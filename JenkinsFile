pipeline {
	agent { label 'windows' }
    // parameters {
	// 		string(name: 'aws_profile', defaultValue: 'aws-nonprod', description: 'Provide aws profile')
	// 		string(name: 'aws_region', defaultValue: 'us-west-2', description: 'Provide aws region')
	// 		gitParameter branchFilter: 'origin/(.*)', defaultValue: 'master', name: 'BRANCH', type: 'PT_BRANCH'
    //         choice(name: 'build_type', choices:['Release', 'Debug'], description: 'Build a Release or Debug version of deployment artifacts.  A Debug build is used for Veracode scanning.')
	// }
	stages {
		stage('Output Current Build Information') {
			steps {
				script {
					//currentBuild.description = """ Profile: ${params.aws_profile} Branch: ${params.BRANCH} Region: ${params.aws_region} """
					currentBuild.description = """ Profile: test_Profile Branch: test_Branch Region: test_Region """
				}
		        bat "\"${tool 'msbuild'}\" -version"
			}
		}
        // stage('Assume Role') {
        //     steps {
        //         script {
        //             wrap([$class: 'AnsiColorBuildWrapper', colorMapName: 'xterm']) {
        //                 assume_role.assume_role(params.aws_profile)
        //             }
        //         }
        //     }
        // }


		stage('restore') {
			steps {

				bat "IF EXIST \"c:/build/sampleapp\" RMDIR /S /Q \"c:/build/sampleapp\""

				// Download nuget packages
				bat 'nuget restore sample-dotnetframework-app/SampleNetApp/SampleApplication.sln'
			
				// Build the solution
		        bat "\"${tool 'msbuild'}\" sample-dotnetframework-app/SampleNetApp/SampleApplication.sln /p:Configuration=${params.build_type} /p:Platform=\"Any CPU\" /p:ProductVersion=1.0.0.${env.BUILD_NUMBER} /p:GenerateBuildInfoConfigFile=false /p:GenerateProjectSpecificOutputFolder=True /p:SkipInvalidConfigurations=true /p:OutDir=c:\\build\\sampleapp /p:langversion=latest"

 				// //Move C# aspx pages to new location
                //powershell "Move-Item -Path 'Website/SCIWebsite/SCI.Framework.Web/Bin/SCI.Framework.Web/_PublishedWebsites/SCI.Framework.Web' -Destination 'Website/SCIWebsite/Bin/SCIWebsite/_PublishedWebsites/SCIWebsite' -force"
                // // Combine bin directories
                // powershell "Copy-Item -Path 'Website/SCIWebsite/Bin/SCIWebsite/_PublishedWebsites/SCIWebsite/SCI.Framework.Web/Bin' -Destination 'Website/SCIWebsite/Bin/SCIWebsite/_PublishedWebsites/SCIWebsite' -force"
                
			}
		}
		
	
	}

	post {
		always {
			echo 'testing'
		}
		success {
			echo 'successful run :)'
		}
		failure {
			echo 'Failure :('
		}
		unstable {
			echo 'unstable :O'
		}
		changed {
			echo 'chaned :]'
		}
	
	}
}